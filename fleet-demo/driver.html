<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8">
<script src="/d3.v3.min.js"></script>
<script src="/dimple.v2.1.2.min.js"></script>
<script src="/jquery-3.3.1.min.js"></script>
<link rel="icon" type="image/png" href="/car-152-232990.webp"/>
<script src="/jquery-editable-select.min.js"></script>
<link rel="stylesheet" type="text/css" href="/jquery-editable-select.min.css"/>
<link rel="stylesheet" type="text/css" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css"/>
<style>
</style>
</head>
<body>
<div id="menu">
</div>
<div class="main-cont" style="height: 900px;">
	<script type="text/javascript">
		$("#menu").load("/menu");
		$("footer").load("/footer");
		var drivers = {}, reportDetails = {};
		var actions = JSON.parse('{"select1":"Timothy","select2":"CollectionAmount"}');
		function LoadData(method,control,value,callbackcheck, callbackFunction)
		{
			$.ajax({
					type: "GET",
					url: method,
					success: function(data){
						// Use jQuery's each to iterate over the opts value
						var a = "selected";
						$.each(data, function(i, d) {
							// You will need to alter the below to get the right values from your json object.  Guessing that d.id / d.modelName are columns in your carModels data
							$(control).append('<option value="' + d[value] + '" '+ ((d[value] == "Timothy" || d[value] == "CollectionAmount") ? a : "") +'>' + d[value] + '</option>');
						});
						$(control).editableSelect({ effects: 'fade' })
						.on('select.editable-select', function (e, li) {
							$(callbackcheck).html(
								li.text()
							);
							actions[e.currentTarget.attributes["id"].nodeValue] = li.text();
							if(typeof callbackFunction == "function")
							{
								callbackFunction(actions);
							}
							else
							{
								jQuery.each(callbackFunction, function(i, eachVal){
									eachVal(actions);
								  });
							}
						});
					}
				});
		}
		function LoadDataDNE(actions)
		{
			var method = '/getconsolidateddate?name=' + actions;
			var dataKey = [	
							"AdvanceCollected","CashCollection","CollectionAmount",	"DriverEarnings","FuelExpense","Incentives","NetEarnings",
							"OLAFees","OperatorBill","PaidByOlaMoney","Penalty","PendingSettlement","SetteledAmount","TollParking"
						];			
			$.ajax({
					type: "GET",
					url: method,
					success: function(data){
						
						$.each(data, function(i, d) {
								switch (d.AmountType) {
									case 'AdvanceCollected': 
										$(".AdvanceCollected").html("₹" + d.Amount);
										break;
									case 'CashCollection': 
										$(".CashCollection").html("₹" + d.Amount);
										break;
									case 'DriverEarnings': 										 
										$(".DriverEarnings").html("₹" + d.Amount);
										break;
									case 'FuelExpense': 
										$(".FuelExpense").html("₹" + d.Amount);
										break;									
									case 'TollParking':
										$(".TollParking").html("₹" + d.Amount);
										break;
									case 'Incentives': 										 
										$(".Incentives").html("₹" + d.Amount);
										break;
									case 'Penalty': 
										$(".Penalty").html("₹" + d.Amount);
										break;									
									case 'OLAFees':
										$(".OLAFees").html("₹" + d.Amount);
										break;																	
									case 'PaidByOlaMoney':
										$(".PaidByOlaMoney").html("₹" + d.Amount);
										break;																								
									case 'OperatorBill':
										$(".OperatorBill").html("₹" + d.Amount);
										break;
									case 'NetEarnings':
										$(".NetEarnings").html("₹" + d.Amount);
										break;
									case 'SetteledAmount':
										$(".SetteledAmount").html("₹" + d.Amount);
										break;
										
										
								}
						});
						
					}
				});
		}
	</script>
	<h1>Drivers Fleet Management</h1>
	<div style=" float: left; margin-right: 120px; ">
		<span>Drivers:</span>
		<select class="form-control" style="width:169px" id="select1">
		</select>
	</div>
	<div style="margin-top:10px">
		<span> Details:</span>
		<select class="form-control" style="width:169px" id="select2">
		</select>
	</div>
	<hr/>
	<div id='chartContainer2' style='display:inline-block'>
		<h1><span class="last-selected">Timothy</span></h1>
		<h2>driver: <span id="last-selected1">Collection Amount</span></h2>
		<script type="text/javascript">
			var svg2 = dimple.newSvg('#chartContainer2', 600,400);
			var ChartInstance;
			d3.json('/getfleetreport?name=' + actions["select1"] + '&reportfor=' + actions["select2"], function(data) {
				$('#MonthID').html(data[0].Month);
				ChartInstance = new dimple.chart(svg2,data);
				var x = ChartInstance.addCategoryAxis('x', 'Date');
				var y = ChartInstance.addMeasureAxis('y', actions["select2"]);
				ChartInstance.setBounds(60,30,510,305);
				var s = ChartInstance.addSeries(["Month"], dimple.plot.bar);
				ChartInstance.addLegend(60, 10, 510, 20, "right");
				ChartInstance.draw(1000);
				LoadDataDNE(actions["select1"]);
				});
			$( document ).ready(function() {
				LoadData("/getDrivers",'#select1', "Driver name",'.last-selected',[drawBarSVGX]);
				LoadData("/getreportparams",'#select2', "ReportFor",'#last-selected1',drawBarSVGY);				
 			});
			function drawBarSVGX(actions)
			 {
				d3.json('/getfleetreport?name=' + actions["select1"] + '&reportfor=' + actions["select2"], function(data) {
					//$('#MonthID').html(data[0].Month);
					ChartInstance.data = data;
					ChartInstance.draw(1000);
					LoadDataDNE(actions["select1"]);
				});
			 }
			 function drawBarSVGY(actions)
			 {
				d3.json('/getfleetreport?name=' + actions["select1"] + '&reportfor=' + actions["select2"], function(data) {
					//$('#MonthID').html(data[0].Month);
					ChartInstance.data = data;
					ChartInstance.axes[1].measure = actions["select2"];
					ChartInstance.draw(1000);
				});
			 }
		</script>
	</div>
	<div id='PiechartContainer12' style='display:inline-block'>
		<br>
		<!-- <h3>Share By CollectionAmount, PendingSettlement, DriverEarnings, Incentives </h3>
		<h4><i>*For the month of <span id="MonthID">Month</span> 2018 </i>
		<h4>
		<script type="text/javascript">
			var svg12 = dimple.newSvg("#PiechartContainer12", 590, 400);
			var ChartInstance1;
			d3.json('/getconsolidateddate?name=' + actions["select1"], function(data) {
				$('#MonthID').html(data[0].Month);
				ChartInstance1 = new dimple.chart(svg12, data);
				ChartInstance1.setBounds(20, 20, 460, 360)
				ChartInstance1.addMeasureAxis("p", ["Amount"]);
				ChartInstance1.addSeries( ["AmountType"], dimple.plot.pie);
				ChartInstance1.addLegend(500, 20, 90, 300, "left");
				ChartInstance1.draw();
				});
			function drawBarPIE(actions)
			 {
				d3.json('/getconsolidateddate?name=' + actions["select1"], function(data) {
					ChartInstance1.data = data;
					ChartInstance1.draw();
				});
			 }
		</script> -->
	</div>
</div>
<footer></footer>
<!-- START SVG CHARTS -->
<div class="wrapper">
		

	<button type="button" class="btn btn-primary btn-lg float-right" style="
			padding: 4px 57px;
			position: absolute;
			top: 274px;
			right: 378px;
		">
		Driver

		<i class="fas fa-gas-pump"></i>
		  -
		Has to Pay <span class="badge badge-light SetteledAmount"></span>
					  
	</button>

	<div class="svg-container">			
        
		<svg version="1.1" viewbox="0 0 450 450" preserveaspectratio="xMinYMin meet" class="svg-content" style="	">
		<title>Positioning tspan</title>
		<style type="text/css">
						svg {
							font-family: serif;
							font-size: 12mm;
							fill: navy;
						}
						.em {
							fill: royalBlue;
						}
						.minus{
							stroke: red;
						}
						.cash{
							stroke: navy;
							font-style: italic;
						}
						.strong {
							stroke: navy;
							font-style: italic;							
						}
						.rectgl{
							outline: 1px solid #6c757d;							
						}
		</style>
		<defs>
			<marker id="arrow" markerwidth="4" markerheight="10" viewbox="-2 -4 4 4" refx="0" refy="0" markerunits="strokeWidth" orient="auto">
			<polyline points="2,-2 0,0 2,2" stroke="#443c3d" stroke-width="0.75px" fill="none"></polyline>
			</marker>
		</defs>
		<g class="box-group">
		<g transform="translate(-5)">
			<!-- <circle fill="#28a745" cx="255" cy="35" r="35" opacity="1"></circle> -->
			<rect  class="rectgl"  fill="#f8f9fa" x="190" y="05" rx="3" ry="3" width="140" height="40" class="rectgl"  ></rect>
			<text x="200" y="35" font-family="Open Sans Condensed" font-size="10" stroke="none" fill="#fff" font-weight="100" style="text-transform:uppercase; letter-spacing: 1px">
					<tspan class="strong em" y=".6cm">Cash Collected</tspan>
					<tspan class="em"  x="6cm" y="1cm"><a class="CashCollection"></a></tspan>
			</text>
			<!-- <text x="5mm" y="2.1cm" >One,
									<tspan class="em" y="1.6cm">Two,</tspan>
									<tspan class="strong em" y="1.1cm">Three!</tspan>
								</text> -->
		</g>
		<line x1="250" x2="250" y1="45" y2="410" stroke-width="1" stroke="#443c3d" stroke-dasharray="2,1"></line>
		<g transform="translate(136)">
			<rect  class="rectgl"  fill="#f8f9fa" x="-110" y="25" rx="3" ry="3" width="90" height="50"></rect>
			<text x="-110" y="47" font-family="Open Sans Condensed" font-size="10" stroke="none" fill="#fff" font-weight="100" style="text-transform:uppercase; letter-spacing: 1px">
					<tspan class="strong em" x="-2.6cm" y="1cm">Ola Fees</tspan>
					<tspan class="minus" x="-1.0cm" y="1cm">(-)</tspan>
					<tspan class="em"  x="-2.4cm" y="1.4cm"><a class="OLAFees"></a></tspan>
			</text>
		</g>
		<line x1="120" x2="250" y1="60" y2="60" stroke-width="1" stroke="#443c3d" stroke-dasharray="2,1"></line>
		<g transform="translate(136)">
				<rect class="rectgl" fill="#f8f9fa" x="213" y="69" rx="3" ry="3" width="90" height="50"></rect>
				<text x="200" y="47" font-family="Open Sans Condensed" font-size="10" stroke="none" fill="#fff" font-weight="100" style="text-transform:uppercase; letter-spacing: 1px">
						<tspan class="strong em" x="6cm" y="2.1cm">Ola Money</tspan>
						<tspan class="em" x="6.4cm" y="2.6cm"><a class="PaidByOlaMoney"></a></tspan>
				</text>
		</g>
		<line x1="250" x2="350" y1="90" y2="90" stroke-width="1" stroke="#443c3d" stroke-dasharray="2,1"></line>
		<g transform="translate(268)">
			<rect  class="rectgl"  fill="#f8f9fa" x="-240" y="85" rx="3" ry="3" width="90" height="50"></rect>
			<text x="-110" y="47" font-family="Open Sans Condensed" font-size="10" stroke="none" fill="#fff" font-weight="100" style="text-transform:uppercase; letter-spacing: 1px">
					<tspan class="strong em" x="-6.2cm" y="2.6cm">Toll</tspan>
					<tspan class="minus" x="-4.4cm" y="2.6cm">(-)</tspan>
					<tspan class="em"  x="-6.0cm" y="3cm"><a class="TollParking"></a></tspan>
			</text>
		</g>
		<line x1="120" x2="250" y1="110" y2="110" stroke-width="1" stroke="#443c3d" stroke-dasharray="2,1"></line>
		<g transform="translate(400)">
			<rect  class="rectgl"  fill="#f8f9fa" x="-205" y="130" rx="3" ry="3" width="120" height="50"></rect>
			<text x="-195" y="195" font-family="Open Sans Condensed" font-size="10" stroke="none" fill="#fff" font-weight="100" style="text-transform:uppercase; letter-spacing: 1px">
					<tspan class="strong em" x="-5.0cm" y="3.8cm">Operator Bill</tspan>
					<tspan class="em"  x="-4.3cm" y="4.2cm"><a class="OperatorBill"></a></tspan>
			</text>
		</g>
		
		<g transform="translate(136)">
			<rect  class="rectgl"  fill="#f8f9fa" x="-110" y="180" rx="3" ry="3" width="90" height="50"></rect>
			<text x="-110" y="47" font-family="Open Sans Condensed" font-size="10" stroke="none" fill="#fff" font-weight="100" style="text-transform:uppercase; letter-spacing: 1px"> 
					<tspan class="strong em" x="-2.6cm" y="5.2cm">Incentives</tspan>
					<tspan class="em"  x="-2.3cm" y="5.7cm"><a class="Incentives"></a></tspan>
			</text>
		</g>
		<line x1="120" x2="250" y1="200" y2="200" stroke-width="1" stroke="#443c3d" stroke-dasharray="2,1"></line>
		<g transform="translate(268)">
			<rect  class="rectgl"  fill="#f8f9fa" x="-240" y="300" rx="3" ry="3" width="90" height="50"></rect>
			<text x="-240" y="140" font-family="Open Sans Condensed" font-size="10" stroke="none" fill="#fff" font-weight="100" style="text-transform:uppercase; letter-spacing: 1px">
					<tspan class="strong em" x="-5.6cm" y="8.4cm">Fuel</tspan>
					<tspan class="em minus" x="-4.6cm" y="8.4cm">(-)</tspan>
					<tspan class="em"  x="-5.7cm" y="8.8cm"><a class="FuelExpense"></a></tspan>
			</text>
		</g>
		<line x1="120" x2="250" y1="320" y2="320" stroke-width="1" stroke="#443c3d" stroke-dasharray="2,1"></line>
		<g transform="translate(400)">
			<rect  class="rectgl"  fill="#f8f9fa" x="-373" y="360" rx="3" ry="3" width="90" height="50"></rect>
			<text x="-190" y="212" font-family="Open Sans Condensed" font-size="10" stroke="none" fill="#fff" font-weight="100" style="text-transform:uppercase; letter-spacing: 1px">
					<tspan class="strong em" x="-9.7cm" y="10cm">Penalty</tspan>
					<tspan class="minus em" x="-8.0cm" y="10cm">(-)</tspan>
					<tspan class="em"  x="-9.2cm" y="10.4cm"><a class="Penalty"></a></tspan>
			</text>
		</g>
		<line x1="120" x2="250" y1="380" y2="380" stroke-width="1" stroke="#443c3d" stroke-dasharray="2,1"></line>
		
		<!-- NET GROSS Block-->
		
		<g transform="translate(268)">
			<rect  class="rectgl"  fill="#f8f9fa" x="-80" y="245" rx="3" ry="3" width="140" height="50"></rect>
			<text x="-240" y="140" font-family="Open Sans Condensed" font-size="10" stroke="none" fill="#fff" font-weight="100" style="text-transform:uppercase; letter-spacing: 1px">
					<tspan class="strong em" x="-1.8cm" y="7.0cm">operator Earnings</tspan>
					<tspan class="em"  x="-1.0cm" y="7.5cm"><a class="NetEarnings"></a></tspan>
			</text>
		</g>
		<!-- <line x1="120" x2="200" y1="390" y2="390" stroke-width="1" stroke="#443c3d" stroke-dasharray="2,1"></line> -->
		<g transform="translate(400)">
			<rect  class="rectgl"  fill="#f8f9fa" x="-104" y="380" rx="3" ry="3" width="150" height="50">			
			</rect>
			<text x="-370" y="195" font-family="Open Sans Condensed" font-size="10" stroke="none" fill="#fff" font-weight="100" style="text-transform:uppercase; letter-spacing: 1px">
					<tspan class="strong em" x="-2.6cm" y="10.6cm">Gross Driver Earnings</tspan>
					<tspan class="em"  x="-1.3cm" y="11cm"><a class="DriverEarnings"></a></tspan> 			
			</text>
		</g>
		<line x1="250" x2="293" y1="410" y2="410" stroke-width="1" stroke="#443c3d" stroke-dasharray="2,1"></line>
		</g>



		<!-- <g>
				<path d="M145.188,238.575l215.5-215.5c5.3-5.3,5.3-13.8,0-19.1s-13.8-5.3-19.1,0l-225.1,225.1c-5.3,5.3-5.3,13.8,0,19.1l225.1,225
								c2.6,2.6,6.1,4,9.5,4s6.9-1.3,9.5-4c5.3-5.3,5.3-13.8,0-19.1L145.188,238.575z"/>
						</g>
						<g>
								<path d="m40.4,121.3c-0.8,0.8-1.8,1.2-2.9,1.2s-2.1-0.4-2.9-1.2c-1.6-1.6-1.6-4.2 0-5.8l51-51-51-51c-1.6-1.6-1.6-4.2 0-5.8 1.6-1.6 4.2-1.6 5.8,0l53.9,53.9c1.6,1.6 1.6,4.2 0,5.8l-53.9,53.9z"/>
							  </g> -->


		<!-- <g class="box-group" transform="translate(0,100)" style=" display: none; ">
			<g transform="translate(5)">
			<rect  class="rectgl"  fill="#f8f9fa" x="2" y="25" rx="3" ry="3" width="90" height="50"></rect>
			<text x="16" y="47" font-family="Open Sans Condensed" font-size="10" stroke="none" fill="#fff" font-weight="100" style="text-transform:uppercase; letter-spacing: 1px"> <tspan x="26" dy="17">Step #7</tspan>
			</text>
			</g>
			<line x1="100" x2="136" y1="50" y2="50" stroke-width="1" stroke="#443c3d" stroke-dasharray="2,1"></line>
			<g transform="translate(136)">
			<rect  class="rectgl"  fill="#f8f9fa" x="2" y="25" rx="3" ry="3" width="90" height="50"></rect>
			<text x="16" y="47" font-family="Open Sans Condensed" font-size="10" stroke="none" fill="#fff" font-weight="100" style="text-transform:uppercase; letter-spacing: 1px"> <tspan x="26" dy="17">Step #6</tspan>
			</text>
			</g>
			<line x1="230" x2="268" y1="50" y2="50" stroke-width="1" stroke="#443c3d" stroke-dasharray="2,1"></line>
			<g transform="translate(268)">
			<polygon points="60,20 100,40 100,80 60,100 20,80 20,40" fill="#72508d" transform="translate(-12,-10)"></polygon>
			<rect  class="rectgl"  fill="#72508d" stroke="#72508d" stroke-width="0" x="2" y="25" rx="3" ry="3" width="90" height="50"></rect>
			<text x="16" y="47" font-family="Open Sans Condensed" font-size="10" stroke="none" fill="#fff" font-weight="100" style="text-transform:uppercase; letter-spacing: 1px"> <tspan x="26" dy="17">Step #5</tspan>
			</text>
			</g>
			<line x1="362" x2="400" y1="50" y2="50" stroke-width="1" stroke="#443c3d" stroke-dasharray="2,1" marker-start="url(#arrow)"></line>
			<g transform="translate(400)">
			<rect  class="rectgl"  fill="#f8f9fa" x="2" y="25" rx="3" ry="3" width="90" height="50"></rect>
			<text x="16" y="47" font-family="Open Sans Condensed" font-size="10" stroke="none" fill="#fff" font-weight="100" style="text-transform:uppercase; letter-spacing: 1px"> <tspan x="26" dy="17">Step #4</tspan>
			</text>
			</g>
			</g>
			<g class="box-group" transform="translate(0,200)" style=" display: none; ">
			<g transform="translate(5)">
			<rect  class="rectgl"  fill="#f8f9fa" x="2" y="25" rx="3" ry="3" width="90" height="50"></rect>
			<text x="16" y="47" font-family="Open Sans Condensed" font-size="10" stroke="none" fill="#fff" font-weight="100" style="text-transform:uppercase; letter-spacing: 1px"> <tspan x="26" dy="17">Step #8</tspan>
			</text>
			</g>
			<line x1="100" x2="136" y1="50" y2="50" stroke-width="1" stroke="#443c3d" stroke-dasharray="2,1"></line>
			<g transform="translate(136)">
			<rect  class="rectgl"  fill="#f8f9fa" x="2" y="25" rx="3" ry="3" width="90" height="50"></rect>
			<text x="16" y="47" font-family="Open Sans Condensed" font-size="10" stroke="none" fill="#fff" font-weight="100" style="text-transform:uppercase; letter-spacing: 1px"> <tspan x="26" dy="17">Step #9</tspan>
			</text>
			</g>
			<line x1="230" x2="268" y1="50" y2="50" stroke-width="1" stroke="#443c3d" stroke-dasharray="2,1"></line>
			<g transform="translate(268)">
			<rect  class="rectgl"  fill="#f8f9fa" x="2" y="25" rx="3" ry="3" width="90" height="50"></rect>
			<text x="16" y="47" font-family="Open Sans Condensed" font-size="10" stroke="none" fill="#fff" font-weight="100" style="text-transform:uppercase; letter-spacing: 1px"> <tspan x="26" dy="17">Step #10</tspan>
			</text>
			</g>
			<line x1="362" x2="400" y1="50" y2="50" stroke-width="1" stroke="#443c3d" stroke-dasharray="2,1"></line>
			<g transform="translate(392)">
			<circle fill="#000" cx="55" cy="50" r="45" opacity="1"></circle>
			<text x="37" y="58" font-family="Open Sans Condensed" font-size="20" stroke="none" fill="#fff" font-weight="100" style="text-transform:uppercase; letter-spacing: 1px">End</text>
			</g>
			</g> -->
		</svg>
	</div>
</div>
<script type="text/javascript">
		var svg = document.getElementsByTagName("svg");
		var rect = document.getElementsByTagName("rect");
		var text = document.createElementNS('http://www.w3.org/2000/svg', 'text');
		text.setAttribute('x', '10');
		text.setAttribute('y', '20');
		text.setAttribute('fill', '#000');
		text.textContent = 'Hello, I am a blah blah blah blah blah';
	</script>
<style>
		.wrapper {
			padding: 50px 100px;
		}
		.svg-container { 
			display: block;
			right: 65px;
			top: 328px;
			position: absolute;
			width: 700px;
			padding-bottom: 54%;
			vertical-align: middle;
			overflow: hidden;
			background: transparent;
		}
		.svg-content { 
			display: inline-block;
			position: absolute;
			top: 0;
			left: 0;
		}
</style>
<!-- END SVG CHARTS -->
</body>
</html>